# Winserver Prepair Manual
**Подготовка Windows сервера для тестирования**

Для тестирования проектов New Internet Technologies Inc. необходимо установить и настроить Microsoft Windows Server на виртуальных машинах Hyper-v, VMware Workstation или Oracle VirtualBox. Для этого необходимы следующие действия:

- С сайта <ftp://files.netip4.ru/html/ISO/destwin/> скачать нужный образ Microsoft Windows (модифицированный MSDN образ).
- Потом нужно создать виртуальную машину с рекомендуемыми параметрами, и установить на неё Microsoft Windows, скаченный с сайта. Модифицированный образ запрашивает минимум информации для установки, и сразу же создаёт локального пользователя.
- Рекомендуемые параметры следующие:
  - Виртуальных процессоров — не менее 2;
  - Объём ОЗУ для гостевой ОС — не менее 2048 МБ;
  - Максимальный объём жесткого диска — не менее 80 ГБ;
  - Тип контроллера жёсткого диска: SCSI или SATA;
  - В системе должен быть установлен виртуальный DVD-ROM с примонтированным образом дистрибутива WIndows. Можно также примонтировать физический образ диска;
  - В качестве базовой системы загрузки надо выбрать рекомендуемый для устанавливаемой операционной системы загрузчик BIOS или UEFI. Во втором случае нужно также учесть требования к установке SecureBoot и TPM 2.0 (они обязательны для Windows 11);
  - Для экономии дискового пространства необходимо отключить создание автоматических контрольных точек;
  - Остальные параметры виртуальных машин не обязательные, и менять их нужно на свой страх и риск;
  - В модифицированных образах Windows Server логин пользователя *Администратор*, в клиентских версиях Microsoft Windows — *user*;
  - Пароль на все логины: *0A9s8d7F*;
- После установки нужно зайти в систему и установить гостевые дополнения нужной версии. Перезагрузка.
- Потом нужно закрепить в меню *Пуск* наиболее часто требуемые для отладки программы (прежде всего — вызов консоли).
- Затем, необязательно, нужно создать нового администратора *user* с паролем *0A9s8d7F*, войти в этого пользователя в графическом интерфейсе и также настроить для него значки.
- Следующее — настроить разрешение экрана вместо минимального;
- Потом указать в свойствах пользователя *Администратор* и *user*, что их пароль действует неограниченно долго.
- После чего нужно очистить и дефрагментировать диск.
- Затем выключить компьютер и сжать диск виртуальной машины.

Для повторного использования нужны ещё два действия:

- Очистить кэш виртуальной машины и создать её архив в формате 7zip (размер виртуальной машины при этом уменьшится в 2-5 раз).
- Создать точку восстановления виртуальной машины (это должна быть последняя операция).
- Далее можно сразу начать тестирование скриптов, или создать тестувую машину с AD.


